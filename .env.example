# AI Finance Platform - Environment Configuration
# ============================================================================
# Copy this file to .env and update with your actual values
# NEVER commit .env to version control!
#
# Generate secure secrets:
#   SECRET_KEY: python -c "import secrets; print(secrets.token_urlsafe(32))"
#   ENCRYPTION_KEY: python -c "import secrets; print(secrets.token_hex(16))"
#   POSTGRES_PASSWORD: python -c "import secrets; print(secrets.token_urlsafe(24))"
# ============================================================================

# =============================================================================
# CRITICAL SECURITY SECRETS (MUST CHANGE IN PRODUCTION)
# =============================================================================

# Secret key for JWT token signing (min 32 chars, random)
SECRET_KEY=CHANGE_ME_IN_PRODUCTION_use_secrets_token_urlsafe_32

# Encryption key for sensitive data - exactly 32 characters
ENCRYPTION_KEY=CHANGE_ME_IN_PRODUCTION_32chars!

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL credentials (used by Docker and app)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_ME_strong_db_password
POSTGRES_DB=ai_finance_platform

# Database URLs - password must match POSTGRES_PASSWORD
DATABASE_URL=postgresql+asyncpg://postgres:CHANGE_ME_strong_db_password@postgres:5432/ai_finance_platform
DATABASE_URL_SYNC=postgresql://postgres:CHANGE_ME_strong_db_password@postgres:5432/ai_finance_platform
TEST_DATABASE_URL=postgresql+asyncpg://postgres:CHANGE_ME_strong_db_password@postgres:5432/ai_finance_platform_test

# Connection pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

REDIS_URL=redis://redis:6379/0
REDIS_MAX_CONNECTIONS=50

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

APP_NAME=AI Finance Platform
APP_VERSION=0.1.0
ENVIRONMENT=development
DEBUG=false
LOG_LEVEL=INFO

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Main App - JSON array of allowed origins
# PRODUCTION: Only include your actual frontend domain(s)!
# Example: ["https://app.yourfinanceplatform.com","https://www.yourfinanceplatform.com"]
ALLOWED_ORIGINS=["http://localhost:3000","http://localhost:5173","http://localhost:8000"]

# AI Brain Service - Comma-separated origins (internal service)
# This service should only be accessed by the main app, not browsers directly
# PRODUCTION: Restrict to your internal app containers/services
AI_BRAIN_CORS_ORIGINS=http://localhost:8000,http://localhost:8001,http://dev:8000,http://app:8000

# =============================================================================
# JWT/AUTH CONFIGURATION
# =============================================================================

ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# RATE LIMITING
# =============================================================================

RATE_LIMIT_PER_MINUTE=60
AUTH_RATE_LIMIT_PER_MINUTE=10
AI_RATE_LIMIT_PER_MINUTE=5
AI_RATE_LIMIT_PER_HOUR=100
AI_RATE_LIMIT_PARSE_PER_MINUTE=30

# =============================================================================
# ML MODEL CONFIGURATION
# =============================================================================

MODEL_STORAGE_PATH=/app/models
GLOBAL_MODEL_PATH=/app/models/global_categorization_model.pkl
MIN_TRANSACTIONS_FOR_USER_MODEL=50
MIN_CORRECTIONS_FOR_USER_MODEL=10

# =============================================================================
# AI BRAIN (LLM) CONFIGURATION
# =============================================================================

AI_BRAIN_ENABLED=true
AI_BRAIN_URL=http://ai-brain:8080
AI_BRAIN_MODE=http
AI_BRAIN_TIMEOUT=60
HF_HOME=/app/ai_brain/.cache/huggingface

# =============================================================================
# MONITORING & OBSERVABILITY (Phase 3)
# =============================================================================

# Prometheus Metrics
ENABLE_METRICS=true
ENABLE_GPU_METRICS=true
GPU_METRICS_INTERVAL=15.0

# Sentry Error Tracking
# Get your DSN from https://sentry.io/settings/{org}/projects/{project}/keys/
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Grafana (used by docker-compose monitoring profile)
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_grafana_admin_password
GRAFANA_ROOT_URL=http://localhost:3001

# =============================================================================
# EXTERNAL APIs (Optional)
# =============================================================================

# Plaid integration
# PLAID_CLIENT_ID=
# PLAID_SECRET=
# PLAID_ENV=sandbox

# =============================================================================
# PERFORMANCE
# =============================================================================

MAX_WORKERS=4
REQUEST_TIMEOUT=30
